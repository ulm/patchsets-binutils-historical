Fix some heap overflows triggered by invalid binaries.

Fixes taken from upstream cvs/Sebastian Krahmer of SuSe/Tavis Ormandy of 
Gentoo.

http://bugs.gentoo.org/91398

--- bfd/elf.c
+++ bfd/elf.c
@@ -1768,6 +1768,9 @@
     case SHT_DYNAMIC:	/* Dynamic linking information.  */
       if (! _bfd_elf_make_section_from_shdr (abfd, hdr, name, shindex))
 	return FALSE;
+      if (hdr->sh_link > elf_numsections (abfd) || 
+		elf_elfsections (abfd)[hdr->sh_link] == NULL)
+	return FALSE;
       if (elf_elfsections (abfd)[hdr->sh_link]->sh_type != SHT_STRTAB)
 	{
 	  Elf_Internal_Shdr *dynsymhdr;
